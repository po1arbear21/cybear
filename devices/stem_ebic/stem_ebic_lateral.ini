! STEM-EBIC Lateral Device Configuration
! Thin lamella with surface recombination on left/right surfaces
!
!   Geometry (lateral p-n junction):
!   x=500nm ┌─────────────────────────────────────┐ ← Surface recom (x=500nm)
!           │                                     │
!           │  p-region   │   n-region            │
!           │             │                       │
!   x=0     └─────────────────────────────────────┘ ← Surface recom (x=0)
!           y=0         y=1.5μm                  y=5μm
!            ↑            ↑                        ↑
!         P_CONTACT    junction              N_CONTACT
!
!   Lamella thickness: 500nm (x-direction)
!   Device length: 5μm (y-direction)
!   Junction: y = 1.5μm
!   Beam sweeps along y

$py(
# Device geometry
thickness = 300.0        # nm
length    = 5000.0       # nm
junction  = 1500.0       # nm

# Grid refinement for Gaussian beam (σ ≈ 0.1-5nm for 500nm lamella)
dy_fine   = 0.05          # nm (fine grid near beam for Gaussian capture)
dy_coarse = 50.0         # nm (coarse grid away from beam)
)


[transport parameters]
  electrons  = true
  holes      = true
  N_c0       = 6.24672e15 : 1/cm^3
  N_v0       = 3.5e15     : 1/cm^3
  E_gap      = 1.12       : eV
  dos        = "parabolic"
  dist       = "maxwell"
  tabledir   = "tables/"
  stab       = "SG"
  reg_A      = 1e-12
  reg_B      = 0.001
  mob        = false
  alpha      =   0.77,   0.70
  beta       =    2.0,    1.0
  mob_min    =   74.5,  122.3 : cm^2/V/s
  mob_max    = 1430.0,  480.0 : cm^2/V/s
  N_ref      = 8.6e16, 1.4e17 : 1/cm^3
  v_sat      =    1e10,  1e10 : cm/s
  curr_fact  = 1.0 : um
  incomp_ion = false
  ii_tau     = 1.0, 1.0 : ps
  ii_E_dop0  = 45.5, 44.39 : meV
  ii_g       = 2.0, 4.0
  ii_N_crit  = 2e19, 2e19 : 1/cm^3
  ii_dop_th  = 1e25, 1e25 : 1/cm^3

  srh        = true
  srh_tau_n  = 5e-7 : s
  srh_tau_p  = 1e-6 : s

  surf_recom = true
  S_surf     = 1e6  : cm/s


[grid]
  gtype  = "xy"
  max_dx = 5.0 : nm
  max_dy = $(dy_coarse) : nm

! Silicon region (entire device)
[poisson]
  x   = 0.0, $(thickness) : nm
  y   = 0.0, $(length) : nm
  eps = 11.7 : eps0

[transport]
  x = 0.0, $(thickness) : nm
  y = 0.0, $(length) : nm

! p-type doping: heavily doped region (y = 0 to junction-100nm)
[doping]
  x    = 0.0, $(thickness) : nm
  y    = 0.0, $(junction-200) : nm
  acon = 1e18 : 1/cm^3

! p-type doping: graded region near junction (junction-100nm to junction)
! Lower doping creates a smoother field profile at the metallurgical junction
[doping]
  x    = 0.0, $(thickness) : nm
  y    = $(junction-200), $(junction) : nm
  acon = 1e18 : 1/cm^3

! n-type doping (top, y = 1.5 to 5 μm)
[doping]
  x    = 0.0, $(thickness) : nm
  y    = $(junction), $(length) : nm
  dcon = 1e15 : 1/cm^3

! Ohmic contact on p-side (bottom edge, y = 0)
[contact]
  name = "P_CONTACT"
  type = "ohmic"
  x    = 0, $(thickness) : nm
  y    = 0, 0 : nm

! Ohmic contact on n-side (top edge, y = 5 μm)
[contact]
  name = "N_CONTACT"
  type = "ohmic"
  x    = 0, $(thickness) : nm
  y    = $(length), $(length) : nm

! STEM-EBIC beam sweep along y
[beam]
  beam_min  = 0 : nm
  beam_max  = $(length) : nm
  I_beam    = 0.0825 : nA/um       ! Beam current per unit depth (for 2D simulation)
  lamella_t = $(thickness) : nm   ! Lamella thickness (beam path length = device x-extent)
  beam_dist = "line"
  Y_BEAM      = 0, 1000, 2500, 5000 : nm
  N_BEAM      = 11, 61, 26


! Refine around the p-n junction (fine grid for Gaussian beam capture)
[refine grid]
  y  = $(junction-100), $(junction) : nm
  dy = $(dy_coarse), $(dy_fine) : nm
  e  = 1.0

[refine grid]
  y  = $(junction), $(junction+100) : nm
  dy = $(dy_fine), $(dy_coarse) : nm
  e  = 1.0

! Refine near contacts
[refine grid]
  y  = 0, 200 : nm
  dy = 5.0, 20.0 : nm         ! fine near P_CONTACT
  e  = 1.0

[refine grid]
  y  = $(length-200), $(length) : nm
  dy = 20.0, 5.0 : nm         ! fine near N_CONTACT
  e  = 1.0
